<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¹´ä¸Šå¹´ä¸‹æ‹çˆ±å€¾å‘æµ‹è¯• - å‘ç°ä½ çš„å…³ç³»è§’è‰²åŸå‹</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d9fa7aa184ccd246a69cf978ab0acc9d";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* [V5.0] ä¸»é¢˜è‰²ï¼šç„¦ç³–å¥¶æ²¹ */
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #FBF8F2 0%, #FAF0E6 100%); /* å¥¶æ²¹èƒŒæ™¯ */
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(160, 127, 86, 0.15); /* ç„¦ç³–è‰²é˜´å½± */
            margin-bottom: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .header h1 {
            background: linear-gradient(135deg, #A07F56 0%, #856847 100%); /* ç„¦ç³–è‰²æ¸å˜ */
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 2.5em;
            margin-bottom: 15px;
            font-weight: bold;
        }
        
        .header p {
            color: #666;
            font-size: 1.1em;
            margin-bottom: 10px;
        }
        
        .badge {
            display: inline-block;
            background: linear-gradient(135deg, #A07F56 0%, #856847 100%); /* ç„¦ç³–è‰²æ¸å˜ */
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9em;
            margin-top: 10px;
        }
        
        /* 4å®«æ ¼å¸ƒå±€ */
        .dimensions-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 30px 0;
        }
        
        .dimension-card {
            background: linear-gradient(135deg, #FDF8F2 0%, #F5E8D6 100%); /* æµ…å¥¶æ²¹å¡ç‰‡ */
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s;
            border: 2px solid transparent;
        }
        
        .dimension-card:hover {
            transform: translateY(-5px);
            border-color: #A07F56; /* ç„¦ç³–è‰²è¾¹æ¡† */
        }
        
        .dimension-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }
        
        .dimension-name {
            color: #A07F56; /* ç„¦ç³–è‰² */
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 5px;
        }
        
        .dimension-desc {
            color: #666;
            font-size: 0.9em;
        }
        
        .features-list {
            background: linear-gradient(135deg, #FDF8F2 0%, #F5E8D6 100%); /* æµ…å¥¶æ²¹ */
            padding: 25px;
            border-radius: 15px;
            margin: 30px 0;
        }
        
        .features-list h3 {
            color: #A07F56; /* ç„¦ç³–è‰² */
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .features-list ul {
            list-style: none;
        }
        
        /* [V5.0] ç§»é™¤ (å…è´¹) æ ‡ç­¾ */
        .features-list li {
            padding: 10px 0;
            color: #666;
            font-size: 1em;
            border-bottom: 1px solid #F5E8D6; /* æµ…è¾¹æ¡† */
        }
        
        .features-list li:before {
            content: "âœ“ ";
            color: #A07F56; /* ç„¦ç³–è‰² */
            font-weight: bold;
            margin-right: 10px;
        }
        
        .input-group {
            margin: 30px 0;
        }
        
        .input-group input {
            width: 100%;
            padding: 18px;
            border: 2px solid #F5E8D6; /* æµ…è¾¹æ¡† */
            border-radius: 12px;
            font-size: 1.1em;
            text-align: center;
            transition: all 0.3s;
            letter-spacing: 2px;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: #A07F56; /* ç„¦ç³–è‰² */
            box-shadow: 0 0 0 4px rgba(160, 127, 86, 0.1);
        }
        
        .btn {
            width: 100%;
            padding: 18px;
            border: none;
            border-radius: 12px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 15px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #A07F56 0%, #856847 100%); /* ç„¦ç³–è‰²æ¸å˜ */
            color: white;
            box-shadow: 0 8px 25px rgba(160, 127, 86, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(160, 127, 86, 0.4);
        }
        
        .btn-secondary {
            background: white;
            color: #A07F56; /* ç„¦ç³–è‰² */
            border: 2px solid #A07F56;
        }
        
        .btn-secondary:hover {
            background: #FDF8F2;
        }
        
        .error-message {
            background: #ffe0e0;
            color: #d32f2f;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            text-align: center;
            display: none;
        }
        
        .admin-link {
            text-align: center;
            margin-top: 30px;
            color: #999;
            font-size: 0.9em;
            cursor: pointer;
        }
        
        .admin-link:hover {
            color: #A07F56;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #F5E8D6;
            border-radius: 10px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #A07F56 0%, #856847 100%); /* ç„¦ç³–è‰²æ¸å˜ */
            transition: width 0.3s;
            border-radius: 10px;
        }
        
        .progress-text {
            color: #A07F56; /* ç„¦ç³–è‰² */
            text-align: center;
            font-weight: bold;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        
        .question-card {
            background: linear-gradient(135deg, #FDF8F2 0%, #F5E8D6 100%); /* æµ…å¥¶æ²¹ */
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }
        
        .question-text {
            color: #333;
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 25px;
            line-height: 1.6;
        }
        
        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .option {
            padding: 18px;
            background: white;
            border: 2px solid #F5E8D6; /* æµ…è¾¹æ¡† */
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.05em;
            color: #666;
        }
        
        .option:hover {
            border-color: #A07F56; /* ç„¦ç³–è‰² */
            background: #FDF8F2;
            transform: translateX(5px);
        }
        
        .option.selected {
            background: linear-gradient(135deg, #A07F56 0%, #856847 100%); /* ç„¦ç³–è‰²æ¸å˜ */
            color: white;
            border-color: #A07F56;
        }
        
        .navigation-buttons {
            display: flex;
            gap: 15px;
        }
        
        .navigation-buttons .btn {
            margin-top: 0;
        }
        
        .result-banner {
            background: linear-gradient(135deg, #A07F56 0%, #856847 100%); /* ç„¦ç³–è‰²æ¸å˜ */
            color: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .result-banner h2 {
            font-size: 2em;
            margin-bottom: 15px;
        }
        
        .rpi-score {
            font-size: 4em;
            font-weight: bold;
            margin: 20px 0;
        }
        
        .rpi-level {
            display: inline-block;
            background: rgba(255, 255, 255, 0.3);
            padding: 10px 30px;
            border-radius: 25px;
            font-size: 1.2em;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            margin: 40px 0;
        }
        
        .scores-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 30px 0;
        }
        
        .score-item {
            background: linear-gradient(135deg, #FDF8F2 0%, #F5E8D6 100%); /* æµ…å¥¶æ²¹ */
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid #A07F56; /* ç„¦ç³–è‰² */
        }
        
        .score-item-name {
            color: #A07F56; /* ç„¦ç³–è‰² */
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .score-item-value {
            font-size: 1.8em;
            color: #333;
            font-weight: bold;
        }
        
        .score-item-desc {
            color: #999;
            font-size: 0.9em;
            margin-top: 5px;
        }
        
        .type-card {
            background: linear-gradient(135deg, #FDF8F2 0%, #F5E8D6 100%); /* æµ…å¥¶æ²¹ */
            padding: 30px;
            border-radius: 15px;
            margin: 30px 0;
            border: 2px solid #A07F56; /* ç„¦ç³–è‰² */
        }
        
        .type-card h3 {
            color: #A07F56; /* ç„¦ç³–è‰² */
            font-size: 1.8em;
            margin-bottom: 15px;
        }
        
        .type-card p {
            color: #666;
            line-height: 1.8;
            font-size: 1.05em;
        }
        
        .characteristics {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 25px 0;
        }
        
        .characteristic-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .characteristic-title {
            color: #A07F56; /* ç„¦ç³–è‰² */
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .characteristic-list {
            font-size: 0.9em;
            color: #666;
            line-height: 1.6;
        }
        
        .basic-advice {
            background: linear-gradient(135deg, #FDF8F2 0%, #F5E8D6 100%); /* æµ…å¥¶æ²¹ */
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
        }
        
        .basic-advice h4 {
            color: #A07F56; /* ç„¦ç³–è‰² */
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        
        .basic-advice ul {
            list-style: none;
        }
        
        .basic-advice li {
            padding: 10px 0;
            color: #666;
            border-bottom: 1px solid #F5E8D6; /* æµ…è¾¹æ¡† */
        }
        
        .basic-advice li:before {
            content: "ğŸ’¡ ";
            margin-right: 10px;
        }
        
        .unlock-section {
            background: linear-gradient(135deg, #FFEFD5 0%, #F5DEB3 100%); /* æµ…é‡‘è‰²/é»„è¤è‰² */
            padding: 40px;
            border-radius: 20px;
            margin: 40px 0;
            border: 3px solid #D55D30; /* å¼ºå¯¹æ¯”è‰²ï¼šé™¶åœŸæ©™ */
        }
        
        .unlock-section h3 {
            color: #D55D30; /* é™¶åœŸæ©™ */
            font-size: 2em;
            text-align: center;
            margin-bottom: 25px;
        }
        
        .comparison-table {
            background: white;
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
        }
        
        .comparison-row {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid #F5E8D6;
        }
        
        .comparison-row:last-child {
            border-bottom: none;
        }
        
        .comparison-free {
            color: #999;
        }
        
        .comparison-paid {
            color: #D55D30; /* é™¶åœŸæ©™ */
            font-weight: bold;
        }
        
        .price-tag {
            text-align: center;
            margin: 30px 0;
        }
        
        .original-price {
            text-decoration: line-through;
            color: #999;
            font-size: 1.2em;
        }
        
        .current-price {
            color: #D55D30; /* é™¶åœŸæ©™ */
            font-size: 3em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .price-note {
            color: #666;
            font-size: 0.9em;
        }
        
        /* --- [V5.0] æ”¯ä»˜æ¨¡å— CSS --- */
        .payment-section {
            width: 100%;
            max-width: 450px;
            margin: 20px auto 0 auto;
            background: white;
            padding: 25px;
            border-radius: 15px;
        }

        .quick-pay-buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 20px;
        }

        .payment-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 15px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            text-decoration: none;
            color: white;
            transition: transform 0.2s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .payment-btn .icon {
            margin-right: 8px;
            font-size: 18px;
        }
        .payment-btn:hover {
            transform: translateY(-2px);
            opacity: 0.9;
        }
        .payment-btn.alipay {
            background: #00A3EE; /* æ”¯ä»˜å®è“ */
        }
        .payment-btn.wechat {
            background: #07C160; /* å¾®ä¿¡ç»¿ */
        }

        .divider-or {
            text-align: center;
            color: #aaa;
            margin: 25px 0;
            position: relative;
        }
        .divider-or span {
            background: white; /* æ”¯ä»˜æ¨¡å—çš„ç™½è‰²èƒŒæ™¯ */
            padding: 0 10px;
            position: relative;
            z-index: 1;
        }
        .divider-or:before {
            content: "";
            position: absolute;
            left: 0;
            top: 50%;
            width: 100%;
            height: 1px;
            background: #e0e0e0;
            z-index: 0;
        }

        .scan-title, .transfer-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            text-align: center;
            margin-bottom: 20px;
        }

        .qr-code-grid {
            display: flex;
            flex-direction: column; /* å‚ç›´å¸ƒå±€ */
            align-items: center; /* å±…ä¸­ */
            gap: 25px; /* å‚ç›´é—´è· */
            text-align: center;
        }
        .qr-code-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .qr-code-item img {
            width: 140px;
            height: 140px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .btn-save {
            display: inline-block;
            margin-top: 15px;
            padding: 8px 16px;
            background: #f0f0f0;
            color: #555;
            border-radius: 6px;
            font-size: 13px;
            text-decoration: none;
            font-weight: 500;
            transition: background 0.2s;
        }
        .btn-save:hover {
            background: #e0e0e0;
        }

        .scan-tip {
            text-align: center;
            font-size: 13px;
            color: #888;
            background: #fafafa;
            padding: 10px;
            border-radius: 6px;
            margin-top: 20px;
        }

        .transfer-payment {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .copy-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f8f9fa;
            padding: 12px 15px;
            border-radius: 8px;
        }
        .copy-item span {
            font-size: 15px;
            color: #333;
            font-weight: 500;
            word-break: break-all;
        }
        .copy-item button {
            padding: 8px 14px;
            border: none;
            background: #A07F56; /* ç„¦ç³–è‰² */
            color: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            margin-left: 10px;
            flex-shrink: 0;
        }
        .copy-item button:hover {
            background: #856847; /* æ·±ç„¦ç³–è‰² */
        }
        /* --- [V5.0] CSS ç»“æŸ --- */
        
        .report-section {
            background: white;
            padding: 35px;
            border-radius: 15px;
            margin: 30px 0;
            border-left: 5px solid #A07F56; /* ç„¦ç³–è‰² */
        }
        
        .report-section h3 {
            color: #A07F56; /* ç„¦ç³–è‰² */
            font-size: 1.8em;
            margin-bottom: 20px;
        }
        
        .report-section h4 {
            color: #856847; /* æ·±ç„¦ç³–è‰² */
            font-size: 1.3em;
            margin: 25px 0 15px 0;
        }
        
        .report-section p {
            color: #666;
            line-height: 1.8;
            font-size: 1.05em;
            margin-bottom: 15px;
        }
        
        .personality-types {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 25px 0;
        }
        
        .personality-type {
            background: linear-gradient(135deg, #FDF8F2 0%, #F5E8D6 100%); /* æµ…å¥¶æ²¹ */
            padding: 20px;
            border-radius: 12px;
        }
        
        /* åŠ¨æ€é«˜äº®æ ·å¼ */
        .personality-type.current {
            border: 3px solid #A07F56;
            background: linear-gradient(135deg, #F5E8D6 0%, #E0D0BB 100%);
        }
        
        .type-number {
            color: #A07F56; /* ç„¦ç³–è‰² */
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .type-name {
            color: #333;
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 5px;
        }
        
        .type-score {
            color: #999;
            font-size: 0.9em;
        }
        
        .action-plan {
            background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
        }
        
        .action-plan h4 {
            color: #2e7d32;
            margin-bottom: 15px;
        }
        
        .action-plan ul {
            list-style: none;
        }
        
        .action-plan li {
            padding: 12px 0;
            color: #555;
            border-bottom: 1px solid #a5d6a7;
        }
        
        .action-plan li:before {
            content: "âœ“ ";
            color: #2e7d32;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .resource-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 25px 0;
        }
        
        .resource-card {
            background: linear-gradient(135deg, #FDF8F2 0%, #F5E8D6 100%);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }
        
        .resource-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .resource-title {
            color: #A07F56; /* ç„¦ç³–è‰² */
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .resource-list {
            font-size: 0.9em;
            color: #666;
            line-height: 1.6;
        }
        
        .dos-donts {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 25px 0;
        }
        
        .dos-card {
            background: linear-gradient(135deg, #E8F5E9 0%, #C8E6C9 100%);
            padding: 25px;
            border-radius: 15px;
        }
        
        .donts-card {
            background: linear-gradient(135deg, #FFE0E0 0%, #FFC8C8 100%); /* æµ…çº¢ */
            padding: 25px;
            border-radius: 15px;
        }
        
        .dos-card h4 {
            color: #2e7d32;
            margin-bottom: 15px;
        }
        
        .donts-card h4 {
            color: #c62828;
            margin-bottom: 15px;
        }
        
        .thank-banner {
            background: linear-gradient(135deg, #A07F56 0%, #856847 100%); /* ç„¦ç³–è‰²æ¸å˜ */
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin: 30px 0;
        }
        
        .thank-banner h3 {
            font-size: 1.8em;
            margin-bottom: 10px;
        }
        
        .admin-panel {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
        }
        
        .admin-panel h2 {
            color: #A07F56; /* ç„¦ç³–è‰² */
            margin-bottom: 30px;
            text-align: center;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #FDF8F2 0%, #F5E8D6 100%); /* æµ…å¥¶æ²¹ */
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }
        
        .stat-number {
            color: #A07F56; /* ç„¦ç³–è‰² */
            font-size: 2.5em;
            font-weight: bold;
        }
        
        .stat-label {
            color: #666;
            margin-top: 10px;
            font-size: 0.9em;
        }
        
        .recent-records {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 12px;
            margin: 25px 0;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .record-item {
            padding: 12px;
            border-bottom: 1px solid #eee;
            font-size: 0.9em;
            color: #666;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .card {
                padding: 25px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .header p {
                font-size: 1em;
            }
            
            .dimensions-grid {
                grid-template-columns: 1fr;
            }
            
            .chart-container {
                height: 320px;
            }
            
            .scores-list {
                grid-template-columns: 1fr;
            }
            
            .characteristics {
                grid-template-columns: 1fr;
            }
            
            .personality-types {
                grid-template-columns: 1fr;
            }
            
            .resource-grid {
                grid-template-columns: 1fr;
            }
            
            .dos-donts {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .navigation-buttons {
                flex-direction: column;
            }
            
            .rpi-score {
                font-size: 3em;
            }
        }
        
        @media (max-width: 600px) {
            .card {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.5em;
            }
            
            .question-text {
                font-size: 1.1em;
            }
            
            .option {
                padding: 15px;
                font-size: 1em;
            }
        }
        
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="cardVerifyPage" class="card">
            <div class="header">
                <h1>â˜• å¹´ä¸Šå¹´ä¸‹æ‹çˆ±å€¾å‘æµ‹è¯•</h1>
                <p>å‘ç°ä½ çš„å†…åœ¨å…³ç³»è§’è‰²åŸå‹</p>
                <span class="badge">ğŸ”¬ åŸºäºä¾æ‹ç†è®ºä¸è£æ ¼å¿ƒç†å­¦çš„ä¸“ä¸šè¯„ä¼°</span>
            </div>
            
            <div class="input-group">
                <input type="text" id="cardInput" placeholder="è¯·è¾“å…¥æµ‹è¯„å¡å·" maxlength="20">
            </div>
            
            <button class="btn btn-primary" onclick="verifyCard()">ğŸ§­ å¼€å§‹æµ‹è¯„</button>
            
            <div class="dimensions-grid" style="margin-top: 40px;">
                <div class="dimension-card">
                    <div class="dimension-icon">ğŸ‘‘</div>
                    <div class="dimension-name">ä¸»å¯¼ vs è¿½éš</div>
                    <div class="dimension-desc">å…³ç³»ä¸­çš„æƒåŠ›ä¸è§’è‰²åå¥½</div>
                </div>
                <div class="dimension-card">
                    <div class="dimension-icon">ğŸ›¡ï¸</div>
                    <div class="dimension-name">ç‹¬ç«‹ vs ä¾èµ–</div>
                    <div class="dimension-desc">ä½ å¯¹æƒ…æ„Ÿæ”¯æŒçš„éœ€æ±‚ç¨‹åº¦</div>
                </div>
                <div class="dimension-card">
                    <div class="dimension-icon">ğŸ•°ï¸</div>
                    <div class="dimension-name">ç¨³å®š vs æ¢ç´¢</div>
                    <div class="dimension-desc">ä½ çš„ç”Ÿæ´»èŠ‚å¥ä¸è§„åˆ’å€¾å‘</div>
                </div>
                <div class="dimension-card">
                    <div class="dimension-icon">ğŸ“œ</div>
                    <div class="dimension-name">åŠ¡å® vs ç†æƒ³</div>
                    <div class="dimension-desc">ä½ çš„æœªæ¥é¢„æœŸä¾§é‡ç‚¹</div>
                </div>
            </div>
            
            <div class="features-list">
                <h3>ğŸ“‹ æµ‹è¯„åŒ…å«</h3>
                <ul>
                    <li>40é¢˜ä¸“ä¸šå¿ƒç†é‡è¡¨</li>
                    <li>4å¤§æ ¸å¿ƒç»´åº¦åˆ†æ</li>
                    <li>16å‹è§’è‰²åŸå‹åŒ¹é…</li>
                    <li><strong style="color:#D55D30;">åƒå­—æ·±åº¦æŠ¥å‘Š+ä¸“å±è¡ŒåŠ¨æ–¹æ¡ˆ (Â¥4.9è§£é”)</strong></li>
                </ul>
            </div>
            
            <div class="error-message" id="errorMessage"></div>
            
            <div class="admin-link" onclick="showAdminPanel()">ç®¡ç†å‘˜å…¥å£ â†’</div>
        </div>
        
        <div id="testPage" class="card hidden">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">ç¬¬1é¢˜ / å…±40é¢˜</div>
            
            <div class="question-card">
                <div class="question-text" id="questionText"></div>
                <div class="options" id="optionsContainer"></div>
            </div>
            
            <div class="navigation-buttons">
                <button class="btn btn-secondary" id="prevBtn" onclick="prevQuestion()" style="display: none;">â† ä¸Šä¸€é¢˜</button>
                <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()">ä¸‹ä¸€é¢˜ â†’</button>
            </div>
        </div>
        
        <div id="freeResultPage" class="card hidden">
            <div class="result-banner">
                <h2>â˜• å¹´ä¸Šå¹´ä¸‹å€¾å‘æŠ¥å‘Š</h2>
                <p style="font-size: 1.2em; margin-top: 15px;">ä½ çš„å…³ç³»è§’è‰²åŸå‹ï¼ˆåŸºç¡€ç‰ˆï¼‰</p>
                <div class="rpi-score" id="archetypeIcon">ğŸ‘‘</div>
                <div class="rpi-level" id="archetypeName">å…¨èƒ½å®ˆæŠ¤è€… (MIST)</div>
            </div>
            
            <div class="chart-container">
                <canvas id="radarChart"></canvas>
            </div>
            
            <div class="scores-list" id="scoresList"></div>
            
            <div class="type-card">
                <h3 id="typeName">"å…¨èƒ½å®ˆæŠ¤è€…"äººæ ¼</h3>
                <p id="typeDesc">ä½ å€¾å‘äºæ‰®æ¼”å…³ç³»ä¸­çš„"å¹´ä¸Š"è§’è‰²ï¼Œå…·æœ‰è¾ƒé«˜çš„æƒ…ç»ªæˆç†Ÿåº¦å’Œè´£ä»»æ„Ÿï¼Œå–œæ¬¢åœ¨å…³ç³»ä¸­æä¾›æŒ‡å¯¼å’Œä¿æŠ¤ã€‚ä½ çš„ä¼´ä¾£é€šå¸¸ä¼šæ˜¯å¯»æ±‚å®‰å…¨æ„Ÿå’Œæ–°é²œæ„Ÿçš„"å¹´ä¸‹"ç±»å‹ã€‚</p>
            </div>
            
            <div class="characteristics">
                <div class="characteristic-item">
                    <div class="characteristic-title">ğŸ‘‘ å¹´ä¸Šç‰¹è´¨</div>
                    <div class="characteristic-list">
                        â€¢ å†³ç­–ä¸»å¯¼<br>
                        â€¢ æƒ…ç»ªç¨³å®š<br>
                        â€¢ ç»éªŒä¸°å¯Œ
                    </div>
                </div>
                <div class="characteristic-item">
                    <div class="characteristic-title">ğŸ‘¶ å¹´ä¸‹ç‰¹è´¨</div>
                    <div class="characteristic-list">
                        â€¢ ä¾èµ–ç…§é¡¾<br>
                        â€¢ å¯»æ±‚æµªæ¼«<br>
                        â€¢ ç¼ºä¹è€å¿ƒ
                    </div>
                </div>
                <div class="characteristic-item">
                    <div class="characteristic-title">âš–ï¸ æœ€ä½³åŒ¹é…</div>
                    <div class="characteristic-list">
                        â€¢ æµªæ¼«è¿½éšå‹<br>
                        â€¢ å¹³è¡¡æ¢ç´¢å‹<br>
                        â€¢ ç‹¬ç«‹åŠ¡å®å‹
                    </div>
                </div>
            </div>
            
            <div class="basic-advice">
                <h4>ğŸ’¡ åŸºç¡€å»ºè®®ï¼ˆå…è´¹ç‰ˆï¼‰</h4>
                <ul>
                    <li>æ„è¯†åˆ°è¿‡åº¦ä¿æŠ¤æ¬²å¯èƒ½è®©ä¼´ä¾£æ„Ÿåˆ°å‹åŠ›ã€‚</li>
                    <li>å­¦ä¹ åœ¨åšå†³å®šæ—¶,æ”¾ä¸‹æƒå¨ï¼Œå¤šå€¾å¬ä¼´ä¾£çš„æ„è§ã€‚</li>
                    <li>å…è´¹ç‰ˆåªèƒ½çœ‹åˆ°åŸºæœ¬å€¾å‘ï¼Œå®Œæ•´ç‰ˆæœ‰è¯¦ç»†çš„æ²Ÿé€šå’Œè¾¹ç•Œå»ºç«‹è®¡åˆ’ã€‚</li>
                </ul>
            </div>
            
            <div class="unlock-section">
                <h3 style="font-size: 1.8em; line-height: 1.6; text-align: center; margin-bottom: 25px;">
                    æ‚¨çš„<strong style="color: #D55D30;">åŸºç¡€ç‰ˆ</strong>æŠ¥å‘Šå·²å‡º ğŸ‘‡<br>
                    å¦‚éœ€ <strong style="color: #D55D30;">16å‹è§’è‰²åŸå‹å…¨è§£æ</strong> å’Œ <strong style="color: #D55D30;">æ²Ÿé€šå†²çªè§£å†³æŒ‡å—</strong>ï¼Œå¯ä»˜è´¹è§£é”ï¼š
                </h3>
                
                <div class="comparison-table">
                    <div class="comparison-row">
                        <span class="comparison-free">åŸºç¡€è§’è‰²ï¼ˆ1ç§ï¼‰</span>
                        <span>â†’</span>
                        <span class="comparison-paid">16å‹è§’è‰²åŸå‹å…¨å›¾é‰´</span>
                    </div>
                    <div class="comparison-row">
                        <span class="comparison-free">åŸºç¡€å»ºè®®</span>
                        <span>â†’</span>
                        <span class="comparison-paid">å¹´ä¸Šå¹´ä¸‹è¾¹ç•Œå»ºç«‹è®¡åˆ’</span>
                    </div>
                    <div class="comparison-row">
                        <span class="comparison-free">æ— å†²çªæ–¹æ¡ˆ</span>
                        <span>â†’</span>
                        <span class="comparison-paid">7ç§æ²Ÿé€šå†²çªè§£å†³è¯æœ¯</span>
                    </div>
                    <div class="comparison-row">
                        <span class="comparison-free">æ— èµ„æºåŒ…</span>
                        <span>â†’</span>
                        <span class="comparison-paid">æ¨èä¹¦ç±ã€è¯¾ç¨‹ä¸æµ‹è¯•</span>
                    </div>
                </div>
                
                <div class="price-tag">
                    <div class="original-price">åŸä»· Â¥29.9</div>
                    <div class="current-price">Â¥4.9</div>
                    <div class="price-note">é™æ—¶ç‰¹æƒ  Â· ä¸€æ¯å’–å•¡çš„ä»·æ ¼æ¢æ¥ä¸€æ®µå¥åº·çš„äº²å¯†å…³ç³»</div>
                </div>
                
                <div class="payment-section">
                    <div class="quick-pay-buttons">
                        <a href="https://qr.alipay.com/tsx15981nt9c4aydmvo2h3d" class="payment-btn alipay">
                            <span class="icon">âš¡</span> æ”¯ä»˜å®å¿«æ·æ”¯ä»˜
                        </a>
                        <a href="javascript:void(0);" onclick="alert('è¯·ä½¿ç”¨ä¸‹æ–¹å¤åˆ¶è´¦å·è½¬è´¦åŠŸèƒ½')" class="payment-btn wechat">
                            <span class="icon">âš¡</span> å¾®ä¿¡å¿«æ·æ”¯ä»˜
                        </a>
                    </div>
            
                    <div class="divider-or"><span>æˆ–</span></div>
            
                  <div class="scan-payment">
    <div class="scan-title">ğŸ“± æ‰«ç æ”¯ä»˜</div>
    <div class="qr-code-grid">
        <div class="qr-code-item">
            <img src="wechat_qrcode.jpg" alt="å¾®ä¿¡æ”¶æ¬¾ç " style="width: 140px; height: 140px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
        </div>
        <div class="qr-code-item">
            <img src="alipay_qrcode.png" alt="æ”¯ä»˜å®æ”¶æ¬¾ç " style="width: 140px; height: 140px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
        </div>
    </div>
    <div class="scan-tip">
        ğŸ’¡ å»ºè®®ä½¿ç”¨ä¸Šæ–¹å¿«æ·æ”¯ä»˜æˆ–å¤åˆ¶è´¦å·è½¬è´¦
    </div>
</div>
            
                    <div class="divider-or"><span>æˆ–</span></div>
            
                    <div class="transfer-payment">
                        <div class="transfer-title">ğŸ’³ å¤åˆ¶è´¦å·è½¬è´¦</div>
                        <div class="copy-item">
                            <span id="wechatID">acg707</span>
                            <button onclick="copyToClipboard('acg707', this)">å¤åˆ¶å¾®ä¿¡</button>
                        </div>
<div class="copy-item">
    <span id="alipayID">erudev@163.com</span>
    <button onclick="copyToClipboard('erudev@163.com', this)">å¤åˆ¶æ”¯ä»˜å®</button>
</div>
                    </div>
                </div>
                
                <label for="paymentProofInput" class="btn btn-primary" style="margin-top: 30px; display: flex; align-items: center; justify-content: center; cursor: pointer; background: #D55D30;">
                    ğŸ“¸ ä¸Šä¼ ä»˜æ¬¾æˆªå›¾ï¼ŒæŸ¥çœ‹å®Œæ•´æŠ¥å‘Š
                </label>
                <input type="file" id="paymentProofInput" accept="image/*" onchange="handlePaymentProof(event)" style="display: none;">
                
            </div>
        </div>
        
        <div id="fullReportPage" class="card hidden">
            <div class="thank-banner">
                <h3>â˜• æ„Ÿè°¢ä½ çš„æ”¯æŒï¼</h3>
                <p>å®Œæ•´æ·±åº¦æŠ¥å‘Šå·²ä¸ºä½ ç”Ÿæˆï¼Œè¯·ä¿å­˜æœ¬é¡µé¢éšæ—¶æŸ¥çœ‹</p>
            </div>
            
            <div class="result-banner">
                <h2>ğŸ‘‘ ä½ çš„å¹´ä¸Šå¹´ä¸‹è§’è‰²åŸå‹å…¨è§£æ</h2>
                <div class="rpi-score" id="fullArchetypeIcon">ğŸ‘‘</div>
                <div class="rpi-level" id="fullArchetypeName">å…¨èƒ½å®ˆæŠ¤è€… (MIST)</div>
            </div>
            
            <div class="chart-container">
                <canvas id="fullRadarChart"></canvas>
            </div>
            
            <div class="report-section">
                <h3>ğŸ“œ ç¬¬ä¸€éƒ¨åˆ†ï¼šè§’è‰²å®šä½ä¸æ ¸å¿ƒé©±åŠ¨åŠ›</h3>
                <h4 id="reportArchetypeName">ä½ çš„åŸå‹ï¼š"å…¨èƒ½å®ˆæŠ¤è€…"</h4>
                <p id="reportArchetypeDesc">ä½ çš„å…³ç³»åŸå‹æ˜¯**å…¨èƒ½å®ˆæŠ¤è€… (MIST)**ã€‚è¿™ä»£è¡¨ä½ åœ¨å…³ç³»ä¸­æ‰®æ¼”ç€æä¾›ç¨³å®šã€æŒ‡å¼•æ–¹å‘å’Œè§£å†³é—®é¢˜çš„"å¹´ä¸Š"è§’è‰²ã€‚ä½ æ‹¥æœ‰é«˜æˆç†Ÿåº¦ã€ç‹¬ç«‹è‡ªä¸»å’Œç¨³å®šçš„ç”Ÿæ´»èŠ‚å¥ã€‚ä½ çš„ä¼´ä¾£é€šå¸¸ä¼šæ˜¯å¯»æ±‚å®‰å…¨æ„Ÿå’Œæ–°é²œæ„Ÿçš„"å¹´ä¸‹"ç±»å‹ã€‚</p>
                
                <h4>ä½ çš„æ ¸å¿ƒé©±åŠ¨åŠ›ä¸æŒ‘æˆ˜</h4>
                <p>ä½ çš„æ ¸å¿ƒé©±åŠ¨åŠ›æ˜¯**"è´£ä»»æ„Ÿ"**ä¸**"å®‰å…¨æ„Ÿ"**ã€‚ä½ æ¸´æœ›é€šè¿‡å¯¹å…³ç³»çš„è§„åˆ’å’Œæ§åˆ¶ï¼Œæ¥ç¡®ä¿è¿™æ®µå…³ç³»æ˜¯ç¨³å®šã€å¯é¢„æµ‹çš„ã€‚ä½ çš„æŒ‘æˆ˜åœ¨äºï¼Œä½ å®¹æ˜“åœ¨ä¸çŸ¥ä¸è§‰ä¸­æ‰¿æ‹…äº†è¿‡å¤šçš„è´£ä»»ï¼Œè®©ä¼´ä¾£å¤±å»äº†æˆé•¿çš„ç©ºé—´ï¼Œæœ€ç»ˆå¯¼è‡´å…³ç³»å¤±è¡¡ã€‚</p>
            </div>
            
            <div class="report-section">
                <h3>ğŸ§­ ç¬¬äºŒéƒ¨åˆ†ï¼š16å‹è§’è‰²åŸå‹å›¾é‰´ (ä»˜è´¹å†…å®¹)</h3>
                <div class="personality-types" id="paidTypeList">
                    <!-- åŠ¨æ€ç”Ÿæˆ16ä¸ªç±»å‹ -->
                </div>
            </div>
            
            <div class="report-section">
                <h3>âš–ï¸ ç¬¬ä¸‰éƒ¨åˆ†ï¼šå¹´ä¸Šå¹´ä¸‹è¾¹ç•Œå»ºç«‹è®¡åˆ’</h3>
                
                <div class="action-plan">
                    <h4>30å¤©è§’è‰²å¹³è¡¡è®¡åˆ’ (ä¸“ç”¨)</h4>
                    <ul>
                        <li>ç¬¬1-10å¤©ï¼šç»ƒä¹ "æ”¾æ‰‹"ï¼Œåœ¨å°äº‹ä¸Šè®©ä¼´ä¾£åšä¸»ï¼Œä¸åŠ è¯„è®ºã€‚</li>
                        <li>ç¬¬11-20å¤©ï¼šæ‰¾å›"è‡ªæˆ‘"ï¼Œæ¯å‘¨è¿›è¡Œä¸€æ¬¡ä¸å¸¦ä¼´ä¾£çš„ä¸ªäººçˆ±å¥½æ´»åŠ¨ã€‚</li>
                        <li>ç¬¬21-30å¤©ï¼šå»ºç«‹"å¹³ç­‰æ²Ÿé€šæ—¥"ï¼ŒåŒæ–¹è½®æµä¸»å¯¼ä¸€æ¬¡é‡å¤§å†³å®šã€‚</li>
                    </ul>
                </div>
                
                <h4>7ç§æ²Ÿé€šå†²çªè§£å†³è¯æœ¯</h4>
                <p style="background: #E8F5E9; padding: 15px; border-radius: 8px; color: #2e7d32;">
                    <strong>åœºæ™¯1ï¼šä¼´ä¾£å¯»æ±‚æŒ‡å¯¼</strong><br>
                    âŒ "ä½ è¿™æ ·æƒ³å°±å¯¹äº†ï¼Œå¬æˆ‘çš„ã€‚"<br>
                    âœ… "è¿™æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œä½†ä½ è§‰å¾—è¿™æ ·åšï¼Œå¯¹ä½ æ¥è¯´æœ€å¤§çš„æŒ‘æˆ˜ä¼šæ˜¯ä»€ä¹ˆï¼Ÿ" (å°†"æŒ‡å¯¼"å˜æˆ"æé—®")
                </p>
                
                <p style="background: #E8F5E9; padding: 15px; border-radius: 8px; color: #2e7d32; margin-top: 15px;">
                    <strong>åœºæ™¯2ï¼šä¼´ä¾£æŠ±æ€¨ä½ "å¤ªå¼ºåŠ¿"</strong><br>
                    âŒ "æˆ‘è¿™æ˜¯ä¸ºä½ å¥½ï¼Œä½ è¿˜ä¸æ‡‚å—ï¼Ÿ"<br>
                    âœ… "å¯¹ä¸èµ·ï¼Œæˆ‘æ²¡æ³¨æ„åˆ°æˆ‘çš„è¯­æ°”å¤ªé‡äº†ã€‚ä¸‹æ¬¡è¯·æé†’æˆ‘ï¼Œæˆ‘æ›´æƒ³å’Œä½ ä¸€èµ·è®¨è®ºï¼Œè€Œä¸æ˜¯æ›¿ä½ å†³å®šã€‚" (æ‰¿è®¤è‡ªå·±çš„è§’è‰²å¤±è¡¡)
                </p>
            </div>
            
            <div class="report-section">
                <h3>ğŸ“š ç¬¬å››éƒ¨åˆ†ï¼šæˆé•¿èµ„æºåŒ…</h3>
                <div class="resource-grid">
                    <div class="resource-card">
                        <div class="resource-icon">ğŸ“–</div>
                        <div class="resource-title">æ¨èä¹¦ç±</div>
                        <div class="resource-list">
                            1. ã€Šéæš´åŠ›æ²Ÿé€šã€‹<br>
                            2. ã€Šäº²å¯†å…³ç³»ã€‹<br>
                            3. ã€Šäººç”Ÿçš„æ™ºæ…§ã€‹
                        </div>
                    </div>
                    <div class="resource-card">
                        <div class="resource-icon">ğŸ“</div>
                        <div class="resource-title">ä¸“ä¸šè¯¾ç¨‹</div>
                        <div class="resource-list">
                            1. ä¾æ‹æ¨¡å¼ä¿®æ­£è¯¾<br>
                            2. äº²å¯†å…³ç³»å·¥ä½œåŠ<br>
                            3. æƒ…å•†ä¸è‡ªæˆ‘ç®¡ç†
                        </div>
                    </div>
                    <div class="resource-card">
                        <div class="resource-icon">ğŸ”—</div>
                        <div class="resource-title">ä¸“ä¸šæµ‹è¯•</div>
                        <div class="resource-list">
                            1. MBTI å®˜æ–¹æµ‹è¯•<br>
                            2. ä¹å‹äººæ ¼æµ‹è¯•<br>
                            3. DISC è¯„ä¼°
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="report-section">
                <h3>âš ï¸ é¿å‘æŒ‡å—</h3>
                
                <div class="dos-donts">
                    <div class="donts-card">
                        <h4>âŒ åƒä¸‡åˆ«åšçš„3ä»¶äº‹</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li style="padding: 10px 0; border-bottom: 1px solid #FFC8C8;">
                                <strong>1. æŸ¥æ‰‹æœº/ç›‘æ§ç¤¾äº¤åª’ä½“</strong><br>
                                è¿™ç§è¡Œä¸ºä¼šç ´åä¿¡ä»»åŸºç¡€ï¼Œé™ä½ä¼´ä¾£çš„å®‰å…¨æ„Ÿã€‚
                            </li>
                            <li style="padding: 10px 0; border-bottom: 1px solid #FFC8C8;">
                                <strong>2. ç”¨"æˆ‘éƒ½æ˜¯ä¸ºä½ å¥½"æ¥å‹åˆ¶</strong><br>
                                æƒå¨å¼çš„ä¿æŠ¤æ¬²ï¼Œä¼šè®©ä¼´ä¾£å¤±å»è‡ªæˆ‘æˆé•¿ç©ºé—´ã€‚
                            </li>
                            <li style="padding: 10px 0;">
                                <strong>3. å°†è´£ä»»å…¨æ½åœ¨èº«</strong><br>
                                è¿‡åº¦çš„ä»˜å‡ºæ„Ÿå’Œè´£ä»»æ„Ÿå®¹æ˜“å¯¼è‡´å…³ç³»å¤±è¡¡å’Œå†…è€—ã€‚
                            </li>
                        </ul>
                    </div>
                    
                    <div class="dos-card">
                        <h4>âœ… ä¸€å®šè¦åšçš„3ä»¶äº‹</h4>
                        <ul style="list-style: none; padding: 0;">
                            <li style="padding: 10px 0; border-bottom: 1px solid #a5d6a7;">
                                <strong>1. å»ºç«‹"éçˆ¶æ¯"è¾¹ç•Œ</strong><br>
                                å…è®¸ä¼´ä¾£çŠ¯é”™ï¼ŒæŠŠä¼´ä¾£è§†ä¸ºå¹³ç­‰çš„æˆå¹´äººã€‚
                            </li>
                            <li style="padding: 10px 0; border-bottom: 1px solid #a5d6a7;">
                                <strong>2. å…è®¸æƒ…æ„Ÿä¾èµ–</strong><br>
                                åœ¨ç‹¬ç«‹çš„åŒæ—¶ï¼Œä¹Ÿè¦å±•ç¤ºè‡ªå·±çš„è„†å¼±é¢ï¼Œå¢åŠ äº²å¯†æ„Ÿã€‚
                            </li>
                            <li style="padding: 10px 0;">
                                <strong>3. åŸ¹å…»å…±åŒç›®æ ‡</strong><br>
                                ç”¨å…±åŒçš„ç†æƒ³è§„åˆ’æœªæ¥ï¼Œè€Œéä»…ç”¨ç‰©è´¨ç¨³å®šä¼´ä¾£ã€‚
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <button class="btn btn-primary" onclick="generateReportImage()" style="margin-bottom: 15px; background: #D55D30;">ğŸ–¼ï¸ ç”ŸæˆæŠ¥å‘Šå¡ç‰‡ (ä¿å­˜åˆ†äº«)</button>
            
            <div id="saveModal" class="hidden" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 9999; overflow-y: auto; padding: 20px; display: none; flex-direction: column; align-items: center;">
                <div style="color: white; font-size: 18px; margin-bottom: 15px; font-weight: bold; text-align: center;">ğŸ‘‡ é•¿æŒ‰ä¸‹æ–¹å›¾ç‰‡ä¿å­˜åˆ°ç›¸å†Œ ğŸ‘‡</div>
                <img id="generatedReportImg" style="width: 100%; max-width: 450px; border-radius: 10px; box-shadow: 0 0 20px rgba(255,255,255,0.2);">
                <button class="btn btn-secondary" onclick="closeSaveModal()" style="margin-top: 20px; width: auto; padding: 10px 30px; background: white; color: #333; border: none;">å…³é—­</button>
            </div>
            
            <button class="btn btn-secondary" onclick="location.reload()">é‡æ–°æµ‹è¯„</button>
        </div>
        
        <div id="adminPanel" class="card hidden">
            <h2>ğŸ” ç®¡ç†å‘˜åå°</h2>
            <div class="input-group">
                <input type="password" id="adminPassword" placeholder="è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç ">
            </div>
            <button class="btn btn-primary" onclick="verifyAdmin()">ç™»å½•</button>
            
            <div id="adminContent" class="hidden">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalCards">0</div>
                        <div class="stat-label">å¡å¯†æ€»æ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="usedCards">0</div>
                        <div class="stat-label">å·²ä½¿ç”¨</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="unusedCards">0</div>
                        <div class="stat-label">æœªä½¿ç”¨</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="deviceCount">0</div>
                        <div class="stat-label">ç»‘å®šè®¾å¤‡æ•°</div>
                    </div>
                </div>
                
                <h3 style="margin: 30px 0 15px 0;">ç”Ÿæˆå¡å¯†</h3>
                <div class="input-group">
                    <input type="number" id="cardCount" placeholder="è¾“å…¥ç”Ÿæˆæ•°é‡ï¼ˆ1-1000ï¼‰" min="1" max="1000" value="10">
                </div>
                <button class="btn btn-primary" onclick="generateCards()">ç”Ÿæˆå¡å¯†</button>
                
                <h3 style="margin: 30px 0 15px 0;">æœ€è¿‘ä½¿ç”¨è®°å½•</h3>
                <div class="recent-records" id="recentRecords">
                    <div class="record-item">æš‚æ— è®°å½•</div>
                </div>
                
                <button class="btn btn-secondary" onclick="backToMain()">è¿”å›ä¸»é¡µ</button>
            </div>
        </div>
    </div>
    
    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
        const ADMIN_PASSWORD = 'woshishabi';
        
        /* [V5.0] 4ç»´åº¦ x 10é¢˜ = 40é¢˜ */
        const questions = [
            /* ç»´åº¦A: ä¸»å¯¼ vs è¿½éš (å¹´ä¸ŠæŒæ§ç‰¹è´¨) */
            {text: 'åœ¨å…³ç³»ä¸­ï¼Œæˆ‘å€¾å‘äºä¸»åŠ¨è§„åˆ’çº¦ä¼šå’Œæ—…è¡Œã€‚', dimension: 0},
            {text: 'æˆ‘æ›´å–œæ¬¢å¯¹æ–¹å¬ä»æˆ‘çš„æ„è§ï¼Œè€Œä¸æ˜¯äº‰è®ºä¸ä¼‘ã€‚', dimension: 0},
            {text: 'ä¸ºäº†å›¢é˜Ÿå’Œè°ï¼Œæˆ‘æ„¿æ„æ”¾å¼ƒè‡ªå·±çš„è§‚ç‚¹ã€‚', dimension: 0, reverse: true}, // åå‘è®¡åˆ†
            {text: 'æˆ‘ç»å¸¸å……å½“å…³ç³»ä¸­çš„"å†³ç­–è€…"ã€‚', dimension: 0},
            {text: 'æˆ‘å–œæ¬¢æŒæ§é‡‘é’±ï¼Œå¹¶ç®¡ç†å…±åŒçš„è´¢åŠ¡ã€‚', dimension: 0},
            {text: 'æˆ‘æ›´å–œæ¬¢è¢«ç…§é¡¾å’Œå®‰æ’ï¼Œè€Œä¸æ˜¯å»ç…§é¡¾åˆ«äººã€‚', dimension: 0, reverse: true},
            {text: 'æˆ‘æ„¿æ„ä¸ºä¼´ä¾£çš„å¿«ä¹æ‰¿æ‹…å¤§éƒ¨åˆ†è´£ä»»ã€‚', dimension: 0},
            {text: 'æˆ‘å¾ˆéš¾å¯¹ä¼´ä¾£è¯´"ä¸"ï¼Œå³ä½¿æˆ‘ä¸åŒæ„ã€‚', dimension: 0, reverse: true},
            {text: 'æˆ‘æ›´å–œæ¬¢æœ‰äººæ›¿æˆ‘æ‹¿ä¸»æ„ã€‚', dimension: 0, reverse: true},
            {text: 'æˆ‘è®¤ä¸ºå…³ç³»ä¸­åº”è¯¥æœ‰æ˜ç¡®çš„é¢†å¯¼è€…ã€‚', dimension: 0},

            /* ç»´åº¦B: ç‹¬ç«‹ vs ä¾èµ– (å¹´ä¸Šç‹¬ç«‹ç‰¹è´¨) */
            {text: 'é•¿æ—¶é—´ç‹¬å¤„ä¸ä¼šè®©æˆ‘æ„Ÿåˆ°ç„¦è™‘æˆ–å­¤ç‹¬ã€‚', dimension: 1},
            {text: 'æˆ‘æœ‰ä¸€ä¸ªç‹¬ç«‹çš„æœ‹å‹åœˆå’Œçˆ±å¥½ï¼Œä¸éœ€è¦ä¼´ä¾£å‚ä¸ã€‚', dimension: 1},
            {text: 'æˆ‘éœ€è¦ä¼´ä¾£é¢‘ç¹åœ°ç¡®è®¤å¯¹æˆ‘çš„çˆ±å’Œå¿ è¯šã€‚', dimension: 1, reverse: true},
            {text: 'ä¼´ä¾£æ²¡æœ‰åŠæ—¶å›å¤ä¿¡æ¯ï¼Œæˆ‘ä¼šæ„Ÿåˆ°ä¸å®‰ã€‚', dimension: 1, reverse: true},
            {text: 'æˆ‘é€šå¸¸è‡ªå·±è§£å†³é—®é¢˜ï¼Œè€Œä¸æ˜¯ä¾èµ–ä¼´ä¾£ã€‚', dimension: 1},
            {text: 'æˆ‘å¾ˆéš¾åœ¨æ²¡æœ‰ä¼´ä¾£é™ªä¼´çš„æƒ…å†µä¸‹åšé‡è¦çš„äº‹æƒ…ã€‚', dimension: 1, reverse: true},
            {text: 'æˆ‘æ›´å–œæ¬¢ä¼´ä¾£æŠŠTAçš„ç¤¾äº¤åœˆå‘æˆ‘å¼€æ”¾ã€‚', dimension: 1, reverse: true},
            {text: 'æˆ‘èƒ½è½»æ¾å¤„ç†ä¼´ä¾£ä¸åœ¨èº«è¾¹çš„æƒ…ç»ªã€‚', dimension: 1},
            {text: 'æˆ‘å¸¸å¸¸æ‹…å¿ƒä¼´ä¾£ä¼šç¦»å¼€æˆ‘ã€‚', dimension: 1, reverse: true},
            {text: 'æˆ‘å–œæ¬¢å’Œä¼´ä¾£ä¿æŒä¸€å®šçš„å¿ƒç†è·ç¦»å’Œç‹¬ç«‹æ€§ã€‚', dimension: 1},

            /* ç»´åº¦C: ç¨³å®š vs æ¢ç´¢ (å¹´ä¸Šç¨³å®šç‰¹è´¨) */
            {text: 'åœ¨å…³ç³»ä¸­ï¼Œæˆ‘è¿½æ±‚ç¨³å®šå’Œå¯é¢„æµ‹æ€§ã€‚', dimension: 2},
            {text: 'æˆ‘å–œæ¬¢å°è¯•æ–°çš„çº¦ä¼šæ–¹å¼å’Œå†’é™©æ´»åŠ¨ã€‚', dimension: 2, reverse: true},
            {text: 'æˆ‘æ›´çœ‹é‡ä¼´ä¾£çš„æ½œåŠ›ï¼Œè€Œä¸æ˜¯ç»éªŒã€‚', dimension: 2, reverse: true},
            {text: 'æˆ‘å€¾å‘äºåšæŒå›ºå®šçš„çº¦ä¼šä¹ æƒ¯å’Œç”Ÿæ´»èŠ‚å¥ã€‚', dimension: 2},
            {text: 'æˆ‘å–œæ¬¢åˆ†äº«è¿‡å»çš„ç»éªŒå’ŒçŸ¥è¯†ç»™ä¼´ä¾£ã€‚', dimension: 2},
            {text: 'æˆ‘æ›´æ„¿æ„æ”¹å˜è‡ªå·±æ¥é€‚åº”ä¼´ä¾£çš„çˆ±å¥½ã€‚', dimension: 2, reverse: true},
            {text: 'æˆ‘å–œæ¬¢å…³ç³»ä¸­å……æ»¡æµªæ¼«å’ŒæƒŠå–œã€‚', dimension: 2, reverse: true},
            {text: 'æˆ‘æ›´å–œæ¬¢æˆç†Ÿã€æœ‰é˜…å†çš„ä¼´ä¾£ã€‚', dimension: 2},
            {text: 'æˆ‘ä¸å–œæ¬¢å…³ç³»å‘å±•å¾—å¤ªå¿«ï¼Œéœ€è¦æ—¶é—´è§‚å¯Ÿã€‚', dimension: 2},
            {text: 'æˆ‘æ›´çœ‹é‡ä¼´ä¾£çš„æ´»åŠ›å’Œæ¿€æƒ…ã€‚', dimension: 2, reverse: true},

            /* ç»´åº¦D: åŠ¡å® vs ç†æƒ³ (å¹´ä¸ŠåŠ¡å®ç‰¹è´¨) */
            {text: 'æˆ‘åœ¨æ‹çˆ±ä¸­ä¼šè€ƒè™‘åˆ°å¯¹æ–¹çš„ç»æµæ¡ä»¶å’ŒèŒä¸šè§„åˆ’ã€‚', dimension: 3},
            {text: 'æˆ‘æ›´å€¾å‘äºç›¸ä¿¡æ„Ÿè§‰å’Œç›´è§‰ï¼Œè€Œä¸æ˜¯äº‹å®å’Œæ•°æ®ã€‚', dimension: 3, reverse: true},
            {text: 'æˆ‘ä¸ºæœªæ¥åˆ¶å®šäº†éå¸¸è¯¦ç»†çš„è®¡åˆ’ï¼ˆå¦‚å‡ å¹´å†…ä¹°æˆ¿/ç»“å©šï¼‰ã€‚', dimension: 3},
            {text: 'æˆ‘æ›´çœ‹é‡å…³ç³»ä¸­çš„æƒ…æ„Ÿè¿æ¥å’Œæµªæ¼«ä½“éªŒã€‚', dimension: 3, reverse: true},
            {text: 'æˆ‘å¸¸å¸¸å¹»æƒ³å®Œç¾çš„çˆ±æƒ…å’Œç†æƒ³çš„ä¼´ä¾£ã€‚', dimension: 3, reverse: true},
            {text: 'æˆ‘æ›´çœ‹é‡ä¼´ä¾£æ˜¯å¦èƒ½ç»™æˆ‘æä¾›ç¨³å®šçš„ç”Ÿæ´»ã€‚', dimension: 3},
            {text: 'æˆ‘å–œæ¬¢è„šè¸å®åœ°åœ°è§£å†³é—®é¢˜ã€‚', dimension: 3},
            {text: 'æˆ‘å€¾å‘äºåœ¨å…³ç³»ä¸­æ‰¿æ‹…åŠ¡å®çš„è§’è‰²ï¼ˆå¦‚è®°è´¦ã€è§„åˆ’æœªæ¥ï¼‰ã€‚', dimension: 3},
            {text: 'æˆ‘å¾ˆå°‘è€ƒè™‘æœªæ¥çš„é•¿æœŸè§„åˆ’ï¼Œæ´»åœ¨å½“ä¸‹ã€‚', dimension: 3, reverse: true},
            {text: 'æˆ‘æ›´æ„¿æ„ä¸ºäº†ç†æƒ³çš„çˆ±æƒ…æ”¾å¼ƒä¸€éƒ¨åˆ†ç‰©è´¨æ¡ä»¶ã€‚', dimension: 3, reverse: true}
        ];
        
        const options = ['å®Œå…¨ä¸åƒæˆ‘', 'ä¸å¤ªåƒæˆ‘', 'ä¸ç¡®å®š', 'æœ‰ç‚¹åƒæˆ‘', 'éå¸¸åƒæˆ‘'];
        
        // [V5.2 ä¿®å¤] 16å‹è§’è‰²åŸå‹ - ä¿®å¤emojiæ˜¾ç¤º
        const archetypeTypes = {
            'MIPT': { name: 'å…¨èƒ½å®ˆæŠ¤è€…', icon: 'ğŸ‘‘', desc: 'é«˜ä¸»å¯¼ã€é«˜ç‹¬ç«‹ã€é«˜ç¨³å®šã€é«˜åŠ¡å®ã€‚æˆç†Ÿç¨³é‡ï¼Œæ˜¯å…³ç³»çš„ç»å¯¹æ”¯æŸ±ã€‚', yearPref: 'å¹´ä¸Š' },
            'MIPF': { name: 'åŠ¡å®å¼•å¯¼è€…', icon: 'ğŸ› ï¸', desc: 'é«˜ä¸»å¯¼ã€é«˜ç‹¬ç«‹ã€é«˜åŠ¡å®ï¼Œä½†æƒ…æ„Ÿä¸Šè¿½æ±‚ç†æƒ³ã€‚æ˜¯èƒ½æä¾›ç‰©è´¨å’Œç²¾ç¥åŒé‡å¼•å¯¼çš„å¹´ä¸Šã€‚', yearPref: 'å¹´ä¸Š' },
            'MIST': { name: 'ç†æ€§å¼•è·¯äºº', icon: 'ğŸ§­', desc: 'é«˜ä¸»å¯¼ã€é«˜ç‹¬ç«‹ã€é«˜ç¨³å®šï¼Œä½†æƒ…æ„Ÿä¸Šç•¥ä¾èµ–ã€‚æ˜¯å…³ç³»ä¸­ç¨³å®šçš„å¯¼å¸ˆå’Œå¼•é¢†è€…ã€‚', yearPref: 'å¹´ä¸Š' },
            'MISF': { name: 'æ¸©æƒ…é¢†èˆªå‘˜', icon: 'ğŸš¢', desc: 'é«˜ä¸»å¯¼ã€é«˜ç‹¬ç«‹ã€é«˜ç†æƒ³ï¼Œæ˜¯èƒ½æä¾›æ–¹å‘å’Œæ¸©æš–çš„å¹´ä¸Šã€‚', yearPref: 'å¹´ä¸Š' },
            
            'MEPT': { name: 'éšæ€§é¢†å¯¼è€…', icon: 'ğŸ’¡', desc: 'é«˜ä¸»å¯¼ã€é«˜æ¢ç´¢ã€é«˜ç¨³å®šï¼Œç‹¬ç«‹æ€§ä¸€èˆ¬ã€‚åœ¨å…³ç³»ä¸­æ˜¯å……æ»¡æ´»åŠ›å’Œæ–°é²œæ„Ÿçš„é¢†å¯¼è€…ã€‚', yearPref: 'å¹´ä¸Š' },
            'MEPF': { name: 'å¼ºåŠ¿æ¢ç´¢å®¶', icon: 'âš¡', desc: 'é«˜ä¸»å¯¼ã€é«˜æ¢ç´¢ã€é«˜åŠ¡å®ï¼Œæ˜¯è¡ŒåŠ¨æ´¾çš„å¹´ä¸Šã€‚', yearPref: 'å¹´ä¸Š' },
            'MEST': { name: 'æŒæ§ä¾èµ–å‹', icon: 'ğŸ”—', desc: 'é«˜ä¸»å¯¼ã€é«˜æ¢ç´¢ï¼Œä½†ç•¥ä¾èµ–å’Œç¨³å®šã€‚å€¾å‘äºæŒæ§ä¸€åˆ‡ï¼Œä½†æƒ…æ„Ÿä¸Šéœ€è¦æ”¯æŒã€‚', yearPref: 'å¹´ä¸Š' },
            'MESF': { name: 'æµªæ¼«æ”¯é…è€…', icon: 'ğŸ”¥', desc: 'é«˜ä¸»å¯¼ã€é«˜æ¢ç´¢ã€é«˜ç†æƒ³ï¼Œæ˜¯å…³ç³»ä¸­å……æ»¡æ¿€æƒ…å’Œæµªæ¼«çš„å¹´ä¸Šã€‚', yearPref: 'å¹´ä¸Š' },

            'DIPT': { name: 'ç‹¬ç«‹å¹³è¡¡å‹', icon: 'âš–ï¸', desc: 'ä½ä¸»å¯¼ï¼ˆè¿½éšï¼‰ã€é«˜ç‹¬ç«‹ã€é«˜ç¨³å®šã€é«˜åŠ¡å®ã€‚è™½ç„¶è¿½éšï¼Œä½†è‡ªæˆ‘ç‹¬ç«‹æ€§å¼ºï¼Œæ˜¯è¿½æ±‚å¹³ç¨³çš„ä¼´ä¾£ã€‚', yearPref: 'å¹³è¡¡' },
            'DIPF': { name: 'åŠ¡å®è¿½éšè€…', icon: 'ğŸ“ˆ', desc: 'ä½ä¸»å¯¼ã€é«˜ç‹¬ç«‹ã€é«˜åŠ¡å®ï¼Œä½†è¿½æ±‚ç†æƒ³ã€‚æ˜¯è„šè¸å®åœ°ï¼Œä½†åˆæ¸´æœ›æµªæ¼«çš„å¹´ä¸‹ã€‚', yearPref: 'å¹³è¡¡' },
            'DIST': { name: 'æ¸©é¡ºçš„è·Ÿéšè€…', icon: 'ğŸ¦¢', desc: 'ä½ä¸»å¯¼ã€é«˜ä¾èµ–ã€é«˜ç¨³å®šã€é«˜åŠ¡å®ã€‚æ¸´æœ›è¢«ç…§é¡¾å’Œå®‰æ’çš„ä¼ ç»Ÿå¹´ä¸‹ã€‚', yearPref: 'å¹´ä¸‹' },
            'DISF': { name: 'éšæ€§ä¾èµ–è€…', icon: 'ğŸ§¸', desc: 'ä½ä¸»å¯¼ã€é«˜ä¾èµ–ã€é«˜ç†æƒ³ï¼Œåœ¨å…³ç³»ä¸­å¯»æ±‚å®‰å…¨æ„Ÿå’Œè¢«ç…§é¡¾ï¼Œæ˜¯å…¸å‹çš„å¹´ä¸‹ã€‚', yearPref: 'å¹´ä¸‹' },

            'DEPT': { name: 'æ¢ç´¢å‹ä¼™ä¼´', icon: 'ğŸ—ºï¸', desc: 'ä½ä¸»å¯¼ã€é«˜æ¢ç´¢ã€é«˜ç¨³å®šï¼Œç‹¬ç«‹æ€§ä¸€èˆ¬ã€‚ä¹äºè·Ÿéšå’Œæ¢ç´¢æ–°äº‹ç‰©ï¼Œæ˜¯å…³ç³»ä¸­çš„æ´»åŠ›ä¼™ä¼´ã€‚', yearPref: 'å¹³è¡¡' },
            'DEPF': { name: 'å¥½å¥‡å®å®', icon: 'ğŸ”', desc: 'ä½ä¸»å¯¼ã€é«˜æ¢ç´¢ã€é«˜åŠ¡å®ï¼Œæ˜¯ç†æ€§é©±åŠ¨çš„å¥½å¥‡è¿½éšè€…ã€‚', yearPref: 'å¹³è¡¡' },
            'DEST': { name: 'å¹³è¡¡æ¢ç´¢å®¶', icon: 'ğŸ¤', desc: 'ä½ä¸»å¯¼ã€é«˜ä¾èµ–ã€é«˜æ¢ç´¢ï¼Œä½†åå‘ç¨³å®šã€‚å¯»æ±‚å¹³è¡¡ï¼Œä¹äºå°è¯•ä½†åº•çº¿ç¨³å®šã€‚', yearPref: 'å¹³è¡¡' },
            'DESF': { name: 'æµªæ¼«è¿½éšè€…', icon: 'âœ¨', desc: 'ä½ä¸»å¯¼ã€é«˜ä¾èµ–ã€é«˜æ¢ç´¢ã€é«˜ç†æƒ³ã€‚å…¸å‹çš„æµªæ¼«ã€ä¾èµ–å‹å¹´ä¸‹ï¼Œä¸ºå…³ç³»å¸¦æ¥æƒ…æ„Ÿä»·å€¼ã€‚', yearPref: 'å¹´ä¸‹' }
        };

        let currentPage = 'verify';
        let currentQuestion = 0;
        let answers = new Array(40).fill(0);
        let currentCard = null;
        
        function getDeviceFingerprint() {
            try {
                let canvasFingerprint = '';
                try {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    if (ctx) {
                        ctx.textBaseline = 'top';
                        ctx.font = '14px Arial';
                        ctx.fillText('fingerprint', 2, 2);
                        canvasFingerprint = canvas.toDataURL().slice(-50);
                    }
                } catch (e) {
                    canvasFingerprint = Date.now().toString();
                }
                
                const fingerprint = [
                    navigator.userAgent || 'unknown',
                    navigator.language || 'unknown',
                    (screen.width || 0) + 'x' + (screen.height || 0),
                    screen.colorDepth || 0,
                    new Date().getTimezoneOffset(),
                    canvasFingerprint
                ].join('|');
                
                let hash = 0;
                for (let i = 0; i < fingerprint.length; i++) {
                    const char = fingerprint.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash;
                }
                
                return 'device_' + Math.abs(hash).toString(36);
            } catch (error) {
                return 'device_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            }
        }
        
        function verifyCard() {
            const cardInput = document.getElementById('cardInput');
            const errorDiv = document.getElementById('errorMessage');
            const cardCode = cardInput.value.trim().toUpperCase();
            const MASTER_CODE = "GEMINI-MASTER";

            console.log('å¼€å§‹éªŒè¯å¡å·:', cardCode); // è°ƒè¯•æ—¥å¿—

            if (cardCode === MASTER_CODE) {
                currentCard = MASTER_CODE;
                showTestPage(); 
                return;
            }
            
            if (!cardCode) {
                errorDiv.textContent = 'è¯·è¾“å…¥æµ‹è¯„å¡å·';
                errorDiv.style.display = 'block';
                return;
            }
            
            // æ¥å—ä¸¤ç§æ ¼å¼ï¼šTF-XXXX-XXXX æˆ– ä»»æ„8-20ä½å­—æ¯æ•°å­—
            if (!/^TF-[A-Z0-9]{4}-[A-Z0-9]{4}$/.test(cardCode) && !/^[A-Z0-9]{8,20}$/.test(cardCode)) {
                errorDiv.textContent = 'å¡å·æ ¼å¼ä¸æ­£ç¡®';
                errorDiv.style.display = 'block';
                return;
            }
            
            const deviceId = getDeviceFingerprint();
            let cards = JSON.parse(localStorage.getItem('ageCards') || '[]');
            let card = cards.find(c => c.code === cardCode);
            
            if (!card) {
                // æ–°å¡å·ï¼Œè‡ªåŠ¨åˆ›å»º
                card = { 
                    code: cardCode, 
                    deviceId: deviceId,
                    createdAt: new Date().toISOString(),
                    firstUsedAt: new Date().toISOString(),
                    testCount: 0
                };
                cards.push(card);
                console.log('åˆ›å»ºæ–°å¡å·:', card);
            } else {
                if (card.deviceId && card.deviceId !== deviceId) {
                    errorDiv.textContent = 'è¯¥å¡å·å·²åœ¨å…¶ä»–è®¾å¤‡ä½¿ç”¨ï¼Œæ— æ³•åœ¨æœ¬è®¾å¤‡ä½¿ç”¨';
                    errorDiv.style.display = 'block';
                    return;
                }
                
                if (!card.deviceId) {
                    card.deviceId = deviceId;
                    card.firstUsedAt = new Date().toISOString();
                }
                console.log('ä½¿ç”¨å·²æœ‰å¡å·:', card);
            }
            
            card.testCount = (card.testCount || 0) + 1;
            card.lastUsedAt = new Date().toISOString();
            
            localStorage.setItem('ageCards', JSON.stringify(cards));
            
            currentCard = card;
            errorDiv.style.display = 'none'; // éšè—é”™è¯¯ä¿¡æ¯
            showTestPage();
        }
        
        function showTestPage() {
            document.getElementById('cardVerifyPage').classList.add('hidden');
            document.getElementById('testPage').classList.remove('hidden');
            document.getElementById('fullReportPage').classList.add('hidden');
            document.getElementById('freeResultPage').classList.add('hidden');

            currentPage = 'test';
            currentQuestion = 0;
            answers = new Array(40).fill(0);
            renderQuestion();
        }
        
        function renderQuestion() {
            const question = questions[currentQuestion];
            document.getElementById('questionText').textContent = `Q${currentQuestion + 1}: ${question.text}`;
            
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';
            
            options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                if (answers[currentQuestion] === index + 1) {
                    optionDiv.classList.add('selected');
                }
                optionDiv.textContent = option;
                optionDiv.onclick = () => selectOption(index + 1);
                optionsContainer.appendChild(optionDiv);
            });
            
            const progress = ((currentQuestion + 1) / 40) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressText').textContent = `ç¬¬${currentQuestion + 1}é¢˜ / å…±40é¢˜`;
            
            document.getElementById('prevBtn').style.display = currentQuestion > 0 ? 'block' : 'none';
            document.getElementById('nextBtn').textContent = currentQuestion === 39 ? 'å®Œæˆæµ‹è¯„ âœ“' : 'ä¸‹ä¸€é¢˜ â†’';
        }
        
        function selectOption(value) {
            answers[currentQuestion] = value;
            renderQuestion(); 

            setTimeout(() => {
                if (currentQuestion < 39) {
                    nextQuestion();
                } else {
                    calculateResult();
                }
            }, 200);
        }
        
        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                renderQuestion();
            }
        }
        
        function nextQuestion() {
            if (answers[currentQuestion] === 0) {
                alert('è¯·é€‰æ‹©ä¸€ä¸ªé€‰é¡¹');
                return;
            }
            
            if (currentQuestion < 39) {
                currentQuestion++;
                renderQuestion();
            } else {
                calculateResult();
            }
        }
        
        /* [V5.8 æœ€ç»ˆä¿®å¤ç‰ˆ] è®¡ç®—ç»“æœå‡½æ•° - ä¿®æ­£é˜ˆå€¼é€»è¾‘ */
        function calculateResult() {
            try {
                const dimensionScores = [0, 0, 0, 0];
                
                // è®¡ç®—åŸå§‹åˆ†æ•°ï¼ˆæ¯ä¸ªç»´åº¦10é¢˜ï¼Œæ»¡åˆ†50ï¼‰
                questions.forEach((q, i) => {
                    let score = answers[i]; // 1-5
                    if (q.reverse) {
                        score = 6 - score; // åå‘è®¡åˆ†
                    }
                    dimensionScores[q.dimension] += score;
                });
                
                console.log('åŸå§‹ç»´åº¦å¾—åˆ† (æ»¡åˆ†50ï¼Œä¸­ä½æ•°30):', dimensionScores);
                
                // è½¬æ¢ä¸º 4-20 åˆ†åˆ¶ç”¨äºå›¾è¡¨å±•ç¤º
                const finalScores = dimensionScores.map(score => 
                    Math.round((score / 50) * 16) + 4
                );
                
                console.log('å›¾è¡¨æ˜¾ç¤ºåˆ†æ•° (4-20):', finalScores);
                
                // 16å‹äººæ ¼è®¡ç®—ï¼šä½¿ç”¨32ä½œä¸ºé˜ˆå€¼ï¼ˆæ»¡åˆ†50çš„64%ï¼Œé¿å…å…¨é€‰"ä¸ç¡®å®š"æ—¶éƒ½æ˜¯M/I/T/Pï¼‰
                // å…¨é€‰"ä¸ç¡®å®š"(3åˆ†)æ—¶ï¼Œæ¯ç»´åº¦æ€»åˆ†=30ï¼Œåº”è¯¥åå‘D/S/E/F
                let typeCode = "";
typeCode += (dimensionScores[0] >= 32) ? "M" : "D"; // ä¸»å¯¼/è¿½éš
typeCode += (dimensionScores[2] >= 32) ? "T" : "E"; // ç¨³å®š/æ¢ç´¢
typeCode += (dimensionScores[1] >= 32) ? "I" : "S"; // ç‹¬ç«‹/ä¾èµ–
typeCode += (dimensionScores[3] >= 32) ? "P" : "F"; // åŠ¡å®/ç†æƒ³
                console.log('è®¡ç®—å‡ºçš„ç±»å‹ä»£ç :', typeCode);
                console.log('åˆ¤æ–­é€»è¾‘: >=32ä¸ºé«˜åˆ†(M/I/T/P), <32ä¸ºä½åˆ†(D/S/E/F)');
                
                const resultType = archetypeTypes[typeCode];
                
                // å¦‚æœç±»å‹ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤ç±»å‹
                if (!resultType) {
                    console.error('é”™è¯¯: æ— æ³•æ‰¾åˆ°ç±»å‹', typeCode);
                    console.log('å¯ç”¨çš„ç±»å‹:', Object.keys(archetypeTypes));
                    
// ä½¿ç”¨æœ€æ¥è¿‘çš„é»˜è®¤ç±»å‹
typeCode = "DESF"; // æµªæ¼«è¿½éšè€…ï¼ˆç¡®ä¿å­˜åœ¨ï¼‰
// ä¸æ˜¾ç¤ºä»»ä½•æç¤ºï¼Œç›´æ¥ä½¿ç”¨é»˜è®¤ç±»å‹
console.warn('ä½¿ç”¨é»˜è®¤ç±»å‹:', typeCode);
                }

                const finalType = archetypeTypes[typeCode];
                console.log('æœ€ç»ˆåŒ¹é…åˆ°çš„äººæ ¼ç±»å‹:', finalType.name, '(', finalType.yearPref, ')');

                sessionStorage.setItem('testResult', JSON.stringify({
                    scores: finalScores,
                    rawScores: dimensionScores,
                    typeCode: typeCode,
                    archetypeIcon: finalType.icon,
                    archetypeName: finalType.name,
                    archetypeDesc: finalType.desc,
                    yearPref: finalType.yearPref
                }));
                
                showFreeResult();
                
            } catch (error) {
                console.error('è®¡ç®—ç»“æœå‡ºé”™:', error);
                alert('è®¡ç®—å‡ºé”™ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•\né”™è¯¯ä¿¡æ¯: ' + error.message);
            }
        }
        
        /* [V5.7 å®Œå…¨ä¿®å¤ç‰ˆ] å…è´¹ç»“æœé¡µ - æ·»åŠ å®Œæ•´é”™è¯¯å¤„ç† */
        function showFreeResult() {
            try {
                const result = JSON.parse(sessionStorage.getItem('testResult'));
                
                if (!result) {
                    throw new Error('æ— æ³•è·å–æµ‹è¯„ç»“æœ');
                }
                
                console.log('æ˜¾ç¤ºç»“æœ:', result);
                
                document.getElementById('cardVerifyPage').classList.add('hidden');
                document.getElementById('testPage').classList.add('hidden');
                document.getElementById('fullReportPage').classList.add('hidden');
                document.getElementById('freeResultPage').classList.remove('hidden');
                currentPage = 'freeResult';

                // å¡«å……æ•°æ®
                document.getElementById('archetypeIcon').textContent = result.archetypeIcon || 'ğŸ‘‘';
                document.getElementById('archetypeName').textContent = (result.archetypeName || 'å…¨èƒ½å®ˆæŠ¤è€…') + ' (' + result.typeCode + ')';
                document.getElementById('typeName').textContent = '"' + (result.archetypeName || 'å…¨èƒ½å®ˆæŠ¤è€…') + '"äººæ ¼';
                document.getElementById('typeDesc').textContent = result.archetypeDesc || 'ä½ æ˜¯å…³ç³»ä¸­çš„å®ˆæŠ¤è€…';
                
                // ç»˜åˆ¶é›·è¾¾å›¾
                drawRadarChart('radarChart', result.scores);
                
                // å¡«å……åˆ†æ•°åˆ—è¡¨
                const scoresList = document.getElementById('scoresList');
                const dimensionNames = ['ä¸»å¯¼ vs è¿½éš', 'ç‹¬ç«‹ vs ä¾èµ–', 'ç¨³å®š vs æ¢ç´¢', 'åŠ¡å® vs ç†æƒ³'];
                const dimensionIcons = ['ğŸ‘‘', 'ğŸ›¡ï¸', 'ğŸ•°ï¸', 'ğŸ“œ'];
                
                scoresList.innerHTML = '';
                result.scores.forEach((score, i) => {
                    const scoreItem = document.createElement('div');
                    scoreItem.className = 'score-item';
                    scoreItem.innerHTML = `
                        <div class="score-item-name">${dimensionIcons[i]} ${dimensionNames[i]}</div>
                        <div class="score-item-value">${score} / 20</div>
                        <div class="score-item-desc">${score > 12 ? 'é«˜åˆ†å€¾å‘' : 'ä½åˆ†å€¾å‘'}</div>
                    `;
                    scoresList.appendChild(scoreItem);
                });
                
                window.scrollTo(0, 0);
                
            } catch (error) {
                console.error('æ˜¾ç¤ºç»“æœé¡µé¢è¯¦ç»†é”™è¯¯:', error);
                alert('æ˜¾ç¤ºç»“æœå‡ºé”™ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•\né”™è¯¯ä¿¡æ¯: ' + error.message);
                location.reload();
            }
        }
        
        function drawRadarChart(canvasId, scores) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            const isMobile = window.innerWidth <= 768;
            
            const existingChart = Chart.getChart(canvasId);
            if (existingChart) {
                existingChart.destroy();
            }
            
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['ä¸»å¯¼/è¿½éš', 'ç‹¬ç«‹/ä¾èµ–', 'ç¨³å®š/æ¢ç´¢', 'åŠ¡å®/ç†æƒ³'],
                    datasets: [{
                        label: 'ä½ çš„å¾—åˆ† (4-20åˆ†)',
                        data: scores,
                        backgroundColor: 'rgba(160, 127, 86, 0.2)',
                        borderColor: '#A07F56',
                        borderWidth: 3,
                        pointBackgroundColor: '#A07F56',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    aspectRatio: isMobile ? 1 : 1.1,
                    layout: {
                        padding: isMobile ? {top: 15, bottom: 15, left: 5, right: 5} : {top: 30, bottom: 30, left: 30, right: 30}
                    },
                    scales: {
                        r: {
                            min: 0,
                            max: 20,
                            ticks: {
                                stepSize: 5,
                                font: {size: isMobile ? 9 : 11}
                            },
                            pointLabels: {
                                font: {size: isMobile ? 11 : 13, weight: 'bold'},
                                color: '#856847',
                                padding: isMobile ? 8 : 15
                            },
                            grid: {color: '#F5E8D6'},
                            angleLines: {color: '#F5E8D6'}
                        }
                    },
                    plugins: {
                        legend: {display: false}
                    }
                }
            });
        }
        
        function handlePaymentProof(event) {
            const file = event.target.files[0];
            if (file) {
                showFullReport();
            }
        }
        
        /* [V5.7 å®Œå…¨ä¿®å¤ç‰ˆ] å®Œæ•´æŠ¥å‘Šé¡µ - åŠ¨æ€ç”Ÿæˆ16å‹å¹¶é«˜äº® */
        function showFullReport() {        
            const result = JSON.parse(sessionStorage.getItem('testResult'));
        
            document.getElementById('cardVerifyPage').classList.add('hidden');
            document.getElementById('testPage').classList.add('hidden');
            document.getElementById('freeResultPage').classList.add('hidden');
            document.getElementById('adminPanel').classList.add('hidden'); 
            document.getElementById('fullReportPage').classList.remove('hidden');

            if (result) {
                document.getElementById('fullArchetypeIcon').textContent = result.archetypeIcon;
                document.getElementById('fullArchetypeName').textContent = result.archetypeName + ' (' + result.typeCode + ')';

                const currentType = archetypeTypes[result.typeCode] || archetypeTypes['MIPT'];
                
                document.getElementById('reportArchetypeName').textContent = 'ä½ çš„åŸå‹ï¼š"' + currentType.name + '"';
                document.getElementById('reportArchetypeDesc').textContent = currentType.desc;

                // ç”Ÿæˆå¹¶é«˜äº®16å‹å›¾é‰´
                const paidTypeList = document.getElementById('paidTypeList');
                paidTypeList.innerHTML = '';
                
                Object.keys(archetypeTypes).forEach(key => {
                    const type = archetypeTypes[key];
                    const typeDiv = document.createElement('div');
                    typeDiv.className = 'personality-type';
                    if (key === result.typeCode) {
                        typeDiv.classList.add('current');
                    }
                    typeDiv.innerHTML = `
                        <div class="type-number">${key}</div>
                        <div class="type-name">${type.name}</div>
                        <div class="type-score">${type.yearPref}å‹</div>
                    `;
                    paidTypeList.appendChild(typeDiv);
                });

                drawRadarChart('fullRadarChart', result.scores);
            }

            window.scrollTo(0, 0);
        }
        
        function showAdminPanel() {
            document.getElementById('cardVerifyPage').classList.add('hidden');
            document.getElementById('adminPanel').classList.remove('hidden');
            document.getElementById('fullReportPage').classList.add('hidden');
            document.getElementById('freeResultPage').classList.add('hidden');
        }
        
        function verifyAdmin() {
            const password = document.getElementById('adminPassword').value;
            
            if (password === ADMIN_PASSWORD) {
                document.getElementById('adminContent').classList.remove('hidden');
                loadAdminStats();
            } else {
                alert('å¯†ç é”™è¯¯');
            }
        }
        
        function loadAdminStats() {
            const cards = JSON.parse(localStorage.getItem('ageCards') || '[]');
            
            const total = cards.length;
            const used = cards.filter(c => c.deviceId).length;
            const devices = new Set(cards.filter(c => c.deviceId).map(c => c.deviceId)).size;
            
            document.getElementById('totalCards').textContent = total;
            document.getElementById('usedCards').textContent = used;
            document.getElementById('unusedCards').textContent = total - used;
            document.getElementById('deviceCount').textContent = devices;
            
            const recentRecords = document.getElementById('recentRecords');
            const recentCards = cards
                .filter(c => c.lastUsedAt)
                .sort((a, b) => new Date(b.lastUsedAt) - new Date(a.lastUsedAt))
                .slice(0, 5);
            
            if (recentCards.length === 0) {
                recentRecords.innerHTML = '<div class="record-item">æš‚æ— è®°å½•</div>';
            } else {
                recentRecords.innerHTML = '';
                recentCards.forEach(card => {
                    const date = new Date(card.lastUsedAt);
                    const dateStr = `${date.getFullYear()}-${(date.getMonth()+1).toString().padStart(2,'0')}-${date.getDate().toString().padStart(2,'0')} ${date.getHours().toString().padStart(2,'0')}:${date.getMinutes().toString().padStart(2,'0')}`;
                    
                    const recordDiv = document.createElement('div');
                    recordDiv.className = 'record-item';
                    recordDiv.textContent = `${card.code} - ä½¿ç”¨${card.testCount || 1}æ¬¡ - ${dateStr}`;
                    recentRecords.appendChild(recordDiv);
                });
            }
        }
        
        function generateCards() {
            const count = parseInt(document.getElementById('cardCount').value);
            
            if (!count || count < 1 || count > 1000) {
                alert('è¯·è¾“å…¥1-1000ä¹‹é—´çš„æ•°å­—');
                return;
            }
            
            const cards = JSON.parse(localStorage.getItem('ageCards') || '[]');
            const newCards = [];
            
            for (let i = 0; i < count; i++) {
                newCards.push({
                    code: generateCardCode(),
                    createdAt: new Date().toISOString()
                });
            }
            
            cards.push(...newCards);
            localStorage.setItem('ageCards', JSON.stringify(cards));
            
            const text = newCards.map(c => c.code).join('\n');
            const blob = new Blob([text], {type: 'text/plain'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `å¹´ä¸Šå¹´ä¸‹æµ‹è¯„å¡å¯†_${new Date().getTime()}.txt`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert(`æˆåŠŸç”Ÿæˆ${count}ä¸ªå¡å¯†ï¼`);
            loadAdminStats();
        }
        
        function generateCardCode() {
            const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
            let code = 'TF-';
            
            for (let i = 0; i < 4; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            
            code += '-';
            
            for (let i = 0; i < 4; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            
            return code;
        }
        
        function backToMain() {
            document.getElementById('adminPanel').classList.add('hidden');
            document.getElementById('cardVerifyPage').classList.remove('hidden');
        }
        
        window.onload = function() {
            const cards = JSON.parse(localStorage.getItem('ageCards') || '[]');
            if (cards.length === 0) {
                const testCards = [];
                for (let i = 0; i < 10; i++) {
                    testCards.push({
                        code: generateCardCode(),
                        createdAt: new Date().toISOString()
                    });
                }
                localStorage.setItem('ageCards', JSON.stringify(testCards));
                console.log('å·²ç”Ÿæˆ10ä¸ªæµ‹è¯•å¡å¯†ï¼Œè¯·åœ¨ç®¡ç†å‘˜åå°æŸ¥çœ‹ï¼ˆå¯†ç ï¼šlss900201ï¼‰');
            }
        };

        function copyToClipboard(text, buttonElement) {
            navigator.clipboard.writeText(text).then(function() {
                const originalText = buttonElement.textContent;
                buttonElement.textContent = 'å·²å¤åˆ¶!';
                buttonElement.style.background = '#07C160';
                setTimeout(() => {
                    buttonElement.textContent = originalText;
                    buttonElement.style.background = '#A07F56';
                }, 2000);
            }, function(err) {
                alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
            });
        }

        function generateReportImage() {
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = 'æ­£åœ¨ç”Ÿæˆå›¾ç‰‡...';
            
            const reportCard = document.getElementById('fullReportPage');
            
            html2canvas(reportCard, {
                scale: 2,
                useCORS: true,
                backgroundColor: '#ffffff',
                ignoreElements: (element) => {
                    return element.tagName === 'BUTTON' || element.id === 'saveModal';
                }
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const modal = document.getElementById('saveModal');
                const img = document.getElementById('generatedReportImg');
                img.src = imgData;
                modal.style.display = 'flex';
                btn.textContent = originalText;
            }).catch(err => {
                console.error(err);
                alert('ç”Ÿæˆå¤±è´¥ï¼Œè¯·æ‰‹åŠ¨æˆªå›¾ä¿å­˜');
                btn.textContent = originalText;
            });
        }

        function closeSaveModal() {
            document.getElementById('saveModal').style.display = 'none';
        }
    </script>
</body>
</html>



